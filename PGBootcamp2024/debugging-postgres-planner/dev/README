Инструментарий отладки
-----------------------

В директории `dev` находятся скрипты автоматизации разработки PostgreSQL:

- `setup.sh` - настройка окружения для разработки: запуск `./configure`,
    создание файлов конфигурации и др. Он запускается 1 раз, перед началом
    разработки.
- `build.sh` - скрипт для запуска сборки
- `run.sh` - скрипт для управления БД и запуска PSQL
- `test.sh` - запуск тестов
- `clean.sh` - очистка репозитория после работы

> Также имеются инфраструктурные скрипты: `get_current_backend_pid.sh`,
> `utils.sh`. Но их лучше не трогать самостоятельно.

У каждого есть опции `-h`/`--help` для отображения информации по каждому.

Эти скрипты должны лежать в директории `dev` в корне проекта (корень исходников
PostgreSQL).

Для VS Code имеются файлы конфигурации: `tasks.json`, `launch.json` и
`c_cpp_properties.json`. Они содержат вспомогательные настройки для IDE -
таски, конфигурации отладчика и т.д.

Таски VS Code можно просмотреть через выпадающее окно тасок с помощью команды
`Tasks: Run Task` (командная панель), либо непосредственно в файле
`.vscode/tasks.json`.


Для автоматизации работы используются скрипты. Краткое введение в скрипты:

1. Запускаем `./dev/setup.sh` когда только приступили к работе, либо удалили
  предыдущие созданные файлы (начинаем заново)
2. Делаем изменения в коде
3. Запускаем сборку БД через `./dev/build.sh`
4. Запускаем тесты через `./dev/test.sh --regress` - проверяем, что ничего не
   сломали
5. Создаем и запускаем БД - `./dev/run.sh --init-db --run-db`
6. Запускаем PSQL - `./dev/run.sh --psql`
7. Ставим где нужно точки останова, запускаем отладчик (F5) и вводим PID нашего
   бэкэнда (высветился в PSQL)
8. Запускаем скрипт, дебажим, завершаем работу, делаем изменения, опять собираем
9. После работы можно очистить созданные файлы - `./dev/clean.sh --build`

Также есть множество тасок для VS Code. Эти шаги можно выполнить с помощью тасок
следующим образом:

1. Запускаем таску `Setup` для настройки окружения
2. Делаем изменения в коде
3. Запускаем сборку БД через таску `Build`, либо сочетанием клавиш `Ctrl + Shift + B`
4. Запускаем тесты через таску `Test regress`, либо сочетанием клавиш `Ctrl + Shift + T`
5. Создаем и запускаем БД - таска `Run DB`
6. Запускаем PSQL - таска `Run psql`
7. Ставим где нужно точки останова, запускаем отладчик (F5) и вводим PID нашего
   бэкэнда (высветился в PSQL)
8. Запускаем скрипт, дебажим, завершаем работу, делаем изменения, опять собираем
9. После работы можно очистить созданные файлы - таска `Clean build`

> Для ускорения запуска тасок можно забиндить команду `Tasks: Run Task`.
> Например, `Alt + T`. После этого, можно запускать нужные таски быстрее
